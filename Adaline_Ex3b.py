import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import SGDRegressor

# Entradas reais (V1, V2, V3)
X_train = np.array([
    [0.425950531568867,  1.31094093866055,  -1.60579308398418],
    [0.81020605733591,   1.11515296917338,  -1.43676223303848],
    [1.11515296917338,   0.81020605733591,  -1.26773138209277],
    [1.31094093866055,   0.425950531568867, -1.09870053114707],
    [1.37840487520902,   0.0,               -0.929669680201368],
    [1.31094093866055,  -0.425950531568866, -0.760638829255665],
    [1.11515296917338,  -0.81020605733591,  -0.591607978309962],
    [0.81020605733591,  -1.11515296917338,  -0.422577127364258],
    [0.425950531568867, -1.31094093866055,  -0.253546276418555],
    [0.0,               -1.37840487520902,  -0.0845154254728517],
    [-0.425950531568866,-1.31094093866055,   0.0845154254728517],
    [-0.81020605733591, -1.11515296917338,   0.253546276418555],
    [-1.11515296917338, -0.81020605733591,   0.422577127364258],
    [-1.31094093866055, -0.425950531568867,  0.591607978309962],
    [-1.37840487520902,  0.0,                0.760638829255665],
    [-1.31094093866055,  0.425950531568866,  0.929669680201368],
    [-1.11515296917338,  0.81020605733591,   1.09870053114707],
    [-0.81020605733591,  1.11515296917338,   1.26773138209277],
    [-0.425950531568867, 1.31094093866055,   1.43676223303848],
    [0.0,                1.37840487520902,   1.60579308398418]
])

# Saída real (y)
y_train = np.array([
    -0.198750516267684,
    0.301021623362128,
    0.503167264361769,
    0.437536735151964,
    0.160192161399815,
    -0.252080285449282,
    -0.70928675363343,
    -1.11703493630872,
    -1.385773848213,
    -1.4395597000417,
    -1.22348980567651,
    -0.709076839632104,
    0.102962625042473,
    1.1827782599265,
    2.47430793935287,
    3.90076549187618,
    5.37215706573455,
    6.79409035408407,
    8.07701437166256,
    9.14498532916549
])

# Modelo Adaline (regressão linear com SGD)
adaline_multi = SGDRegressor(loss="squared_error", penalty=None,
                             learning_rate="constant", eta0=0.01,
                             max_iter=10000, tol=1e-6, random_state=42)

adaline_multi.fit(X_train, y_train)

# Previsão
y_pred = adaline_multi.predict(X_train)

# Gráfico
plt.figure(figsize=(8,5))
plt.plot(y_train, "ro-", label="Saída real")
plt.plot(y_pred, "b--", label="Saída prevista (Adaline)")
plt.xlabel("Amostras")
plt.ylabel("y")
plt.title("Modelo Adaline Multivariado - Saída Original vs Prevista")
plt.legend()
plt.grid(True)
plt.show()

# Coeficientes
print("Intercepto (a) =", adaline_multi.intercept_[0])
print("Pesos (b, c, d) =", adaline_multi.coef_)
